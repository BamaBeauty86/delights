@page "/hello"
@inherits BasePage<Delights.Modules.Hello.Module>
@inject ModuleService Service

<h1>Hello World! from @Module.Manifest.Name </h1>

<Button OnClick="OnClick">Click</Button>

@foreach(var message in messages)
{
    <p>@message.Content</p>
    <br/>
}

@code{
    List<GraphQL.IHelloMessage> messages = new List<GraphQL.IHelloMessage>();

    protected override void OnInitialized()
    {
        Parent.Title = "Hello";
        base.OnInitialized();
    }

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        messages = (await Service.GraphQLClient.GetMessagesAsync()).Data?.HelloMessages.Nodes.ToList() ?? new List<GraphQL.IHelloMessage>();
    }

    void OnClick()
    {
        Parent.Title = "Hello!";
    }
}
